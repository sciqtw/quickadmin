{"version":3,"sources":["webpack:///./src/views/login.vue?2716","webpack:///./src/views/login.vue","webpack:///./src/views/login.vue?eb2f"],"names":["getCurrentInstance","proxy","store","useStore","route","useRoute","title","useRouter","window","config","appName","formType","ref","loginForm","account","localStorage","login_account","captcha","password","remember","resetForm","newPassword","resetRules","required","trigger","message","min","max","loading","passwordType","redirect","baseUrl","base","checkCaptcha","captchaUrl","changeCaptcha","value","Math","random","loginRules","computed","rules","showPassword","nextTick","$refs","focus","handleLogin","loginFormRef","validate","valid","Quick","request","url","loginUrl","method","data","then","res","code","setItem","username","removeItem","location","catch","handleFind","$message","type","resetFormRef","setMenuMode","document","body","removeAttribute","state","settings","sidebarCollapse","setAttribute","menuMode","setDocumentTitle","enableDynamicTitle","onMounted","query","origin","pathname","watch","mode","commit","sidebarCollapseLastStatus","immediate","onresize","documentElement","clientWidth","__exports__"],"mappings":"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","file":"js/chunk-e6661060.4dd3f272.js","sourcesContent":["export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--9-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--9-oneOf-1-1!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--9-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--9-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--1-0!../../node_modules/@vue/cli-service/node_modules/vue-loader-v16/dist/index.js??ref--1-1!./login.vue?vue&type=style&index=0&id=2852f384&lang=scss&scoped=true\"","<template>\n  <div>\n    <div class=\"bg-banner\"/>\n    <div id=\"login-box\">\n      <div class=\"login-banner\"/>\n      <el-form v-show=\"formType == 'login'\" ref=\"loginFormRef\" :model=\"loginForm\" :rules=\"loginRules\" class=\"login-form\"\n               autocomplete=\"on\" label-position=\"left\">\n        <div class=\"title-container\">\n          <h3 class=\"title\">{{ title }}</h3>\n        </div>\n        <div>\n          <el-form-item prop=\"account\">\n            <el-input ref=\"name\" v-model=\"loginForm.account\" placeholder=\"用户名\" type=\"text\" tabindex=\"1\"\n                      autocomplete=\"on\">\n              <template #prefix>\n                <svg-icon icon=\"icon-user\"/>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"password\">\n            <el-input ref=\"password\" v-model=\"loginForm.password\" :type=\"passwordType\" placeholder=\"密码\" tabindex=\"2\"\n                      autocomplete=\"on\" @keyup.enter=\"handleLogin\">\n              <template #prefix>\n                <svg-icon icon=\"icon-password\"/>\n              </template>\n              <template #suffix>\n                <svg-icon :icon=\"passwordType === 'password' ? 'icon-eye' : 'icon-eye-open'\" @click=\"showPassword\"/>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"captcha\" v-if=\"checkCaptcha\">\n            <el-row style=\"flex-wrap: nowrap;width:100%; \">\n              <div style=\"flex-grow: 1;\">\n                <el-input ref=\"captcha\" v-model=\"loginForm.captcha\" placeholder=\"验证码\" type=\"text\"\n                          @keyup.enter=\"handleLogin\">\n                  <template #prefix>\n                    <svg-icon icon=\"icon-captcha\"/>\n                  </template>\n                </el-input>\n              </div>\n              <el-image\n                @click=\"changeCaptcha\"\n                style=\"width: 130px;padding-left:6px;border-radius: 5px;flex-shrink: 0;\"\n                :src=\"captchaUrl\"\n                :fit=\"'fill'\"\n              ></el-image>\n            </el-row>\n          </el-form-item>\n        </div>\n<!--        <div class=\"flex-bar\">-->\n<!--          <el-checkbox v-model=\"loginForm.remember\">记住我</el-checkbox>-->\n<!--          <el-button type=\"text\" @click=\"formType = 'reset'\">忘记密码</el-button>-->\n<!--        </div>-->\n        <el-button :loading=\"loading\" type=\"primary\" style=\"width: 100%;\" @click.prevent=\"handleLogin\">登 录</el-button>\n        <div\n          style=\"margin-top: 20px; margin-bottom: -10px; color: #666; font-size: 14px; text-align: center; font-weight: bold;\"\n          v-if=\"false\">\n          <span style=\"margin-right: 5px;\">演示帐号一键登录：</span>\n          <el-button type=\"danger\" size=\"mini\" @click=\"testAccount('admin')\">admin</el-button>\n        </div>\n      </el-form>\n      <el-form v-show=\"formType == 'reset'\" ref=\"resetFormRef\" :model=\"resetForm\" :rules=\"resetRules\" class=\"login-form\"\n               auto-complete=\"on\" label-position=\"left\">\n        <div class=\"title-container\">\n          <h3 class=\"title\">重置密码</h3>\n        </div>\n        <div>\n          <el-form-item prop=\"account\">\n            <el-input ref=\"name\" v-model=\"resetForm.account\" placeholder=\"用户名\" type=\"text\" tabindex=\"1\"\n                      autocomplete=\"on\">\n              <template #prefix>\n                <svg-icon name=\"user\"/>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"captcha\">\n            <el-input ref=\"captcha\" v-model=\"resetForm.captcha\" placeholder=\"验证码\" type=\"text\" tabindex=\"2\"\n                      autocomplete=\"on\">\n              <template #prefix>\n                <svg-icon name=\"captcha\"/>\n              </template>\n              <template #append>\n                <el-button>发送验证码</el-button>\n              </template>\n            </el-input>\n          </el-form-item>\n          <el-form-item prop=\"newPassword\">\n            <el-input ref=\"newPassword\" v-model=\"resetForm.newPassword\" :type=\"passwordType\" placeholder=\"新密码\"\n                      tabindex=\"3\" autocomplete=\"on\">\n              <template #prefix>\n                <svg-icon name=\"password\"/>\n              </template>\n              <template #suffix>\n                <svg-icon :name=\"passwordType === 'password' ? 'eye' : 'eye-open'\" @click=\"showPassword\"/>\n              </template>\n            </el-input>\n          </el-form-item>\n        </div>\n        <el-row :gutter=\"15\" style=\"padding-top: 20px;\">\n          <el-col :md=\"6\">\n            <el-button style=\"width: 100%;\" @click=\"formType = 'login'\">去登录</el-button>\n          </el-col>\n          <el-col :md=\"18\">\n            <el-button :loading=\"loading\" type=\"primary\" style=\"width: 100%;\" @click.prevent=\"handleFind\">确 认\n            </el-button>\n          </el-col>\n        </el-row>\n      </el-form>\n    </div>\n    <!--    <Copyright v-if=\"$store.state.settings.showCopyright\" />-->\n  </div>\n</template>\n\n<script setup name=\"Login\">\n  import {getCurrentInstance, ref, onMounted, watch, computed} from 'vue';\n  import {useStore} from \"vuex\"\n  import {useRoute, useRouter} from 'vue-router'\n\n  const {proxy} = getCurrentInstance()\n  const store = useStore();\n  const route = useRoute(), router = useRouter();\n\n  const title = window?.config?.appName || \"QuickAdmin\"\n\n  // 表单类型，login 登录，reset 重置密码\n  const formType = ref('login')\n\n  const loginForm = ref({\n    account: localStorage.login_account || '',\n    captcha: '',\n    password: '',\n    remember: !!localStorage.login_account\n  })\n\n\n  const resetForm = ref({\n    account: localStorage.login_account || '',\n    captcha: '',\n    newPassword: ''\n  })\n  const resetRules = ref({\n    account: [\n      {required: true, trigger: 'change', message: '请输入用户名'}\n    ],\n    captcha: [\n      {required: true, trigger: 'change', message: '请输入验证码'}\n    ],\n    newPassword: [\n      {required: true, trigger: 'change', message: '请输入新密码'},\n      {min: 6, max: 18, trigger: 'change', message: '密码长度为6到18位'}\n    ]\n  })\n\n  const loading = ref(false)\n  const passwordType = ref('password')\n  const redirect = ref(null)\n\n  const baseUrl = window?.config?.base || 'index.php'\n  const checkCaptcha = ref(false)\n  const captchaUrl = ref(baseUrl + '/admin/captcha')\n  const changeCaptcha = function () {\n    captchaUrl.value = baseUrl + '/admin/captcha?v=v' + Math.random()\n  }\n\n  const loginRules = computed(() => {\n\n    let rules = {\n      account: [\n        {required: true, trigger: 'blur', message: '请输入用户名'}\n      ],\n      password: [\n        {required: true, trigger: 'blur', message: '请输入密码'},\n        {min: 6, max: 18, trigger: 'blur', message: '密码长度为6到18位'}\n      ]\n    };\n    if (checkCaptcha.value) {\n      rules.captcha = [\n        {required: true, trigger: 'blur', message: '请输入验证码'}\n      ]\n    }\n    return rules\n  })\n\n\n  onMounted(() => {\n    redirect.value = route.query.redirect ?? location.origin + location.pathname\n    if (localStorage.account) {\n      window.location = redirect.value\n    }\n  })\n\n  function showPassword() {\n    passwordType.value = passwordType.value === 'password' ? '' : 'password'\n    nextTick(() => {\n      proxy.$refs.password.focus()\n    })\n  }\n\n  function handleLogin() {\n    proxy.$refs.loginFormRef.validate(valid => {\n      if (valid) {\n        loading.value = true\n        Quick.request({\n          url: window?.config?.loginUrl || \"admin/passport/login\",\n          method: 'POST',\n          data: loginForm.value\n        }).then((res) => {\n          loading.value = false\n\n          if (res.code === 0) {\n            if (loginForm.value.remember) {\n              localStorage.setItem('login_username', loginForm.value.username)\n            } else {\n              localStorage.removeItem('login_username')\n            }\n            window.location = redirect.value\n          } else {\n            checkCaptcha.value = true\n          }\n\n\n        }).catch(() => {\n          checkCaptcha.value = true\n          changeCaptcha()\n          loading.value = false\n        })\n\n      }\n    })\n  }\n\n  function handleFind() {\n    proxy.$message({\n      message: '重置密码仅提供界面演示，无实际功能，需开发者自行扩展',\n      type: 'info'\n    })\n    proxy.$refs.resetFormRef.validate(valid => {\n      if (valid) {\n        // 这里编写业务代码\n      }\n    })\n  }\n\n  function testAccount(account) {\n    loginForm.value.account = account\n    loginForm.value.password = '123456'\n    handleLogin()\n  }\n\n\n  watch(() => store.state.settings.mode, () => {\n    if (store.state.settings.mode === 'pc') {\n      store.commit('settings/updateThemeSetting', {\n        'sidebarCollapse': store.state.settings.sidebarCollapseLastStatus\n      })\n    } else if (store.state.settings.mode === 'mobile') {\n      store.commit('settings/updateThemeSetting', {\n        'sidebarCollapse': true\n      })\n    }\n    document.body.setAttribute('data-mode', store.state.settings.mode)\n  }, {\n    immediate: true\n  })\n\n  watch([\n    () => store.state.settings.menuMode,\n    () => store.state.settings.sidebarCollapse\n  ], () => setMenuMode(), {\n    immediate: true\n  })\n\n  function setMenuMode() {\n    document.body.removeAttribute('data-sidebar-no-collapse')\n    document.body.removeAttribute('data-sidebar-collapse')\n    if (store.state.settings.sidebarCollapse) {\n      document.body.setAttribute('data-sidebar-collapse', '')\n    } else {\n      document.body.setAttribute('data-sidebar-no-collapse', '')\n    }\n    document.body.setAttribute('data-menu-mode', store.state.settings.menuMode)\n  }\n\n  watch([\n    () => store.state.settings.enableDynamicTitle,\n    () => store.state.settings.title\n  ], () => setDocumentTitle(), {\n    immediate: true\n  })\n\n  function setDocumentTitle() {\n    if (store.state.settings.enableDynamicTitle && store.state.settings.title) {\n      let title = store.state.settings.title\n      document.title = `${title} - quick`\n    } else {\n      document.title = 'quick'\n    }\n  }\n\n  onMounted(() => {\n\n    checkCaptcha.value = window?.config?.checkCaptcha\n    window.onresize = () => {\n      store.commit('settings/setMode', document.documentElement.clientWidth)\n    }\n    window.onresize()\n  })\n</script>\n\n<style lang=\"scss\" scoped>\n  [data-mode=\"mobile\"] {\n    #login-box {\n      max-width: 80%;\n\n      .login-banner {\n        display: none;\n      }\n    }\n  }\n\n  :deep(input[type=\"password\"]::-ms-reveal) {\n    display: none;\n  }\n\n  .bg-banner {\n    position: absolute;\n    z-index: 0;\n    width: 100%;\n    height: 100%;\n    background-image: url(\"../assets/images/login-bg.jpg\");\n    background-size: cover;\n    background-position: center center;\n  }\n\n  #login-box {\n    display: flex;\n    justify-content: space-between;\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translateX(-50%) translateY(-50%);\n    background: rgb(255 255 255 / 80%);\n    border-radius: 10px;\n    overflow: hidden;\n    box-shadow: 0 0 5px #999;\n\n    .login-banner {\n      width: 300px;\n      background-image: url(\"../assets/images/login-banner.jpg\");\n      background-size: cover;\n      background-position: center center;\n    }\n\n    .login-form {\n      width: 450px;\n      padding: 50px 35px 30px;\n      overflow: hidden;\n\n      .title-container {\n        position: relative;\n\n        .title {\n          font-size: 22px;\n          color: #666;\n          margin: 0 auto 30px;\n          text-align: center;\n          font-weight: bold;\n          @include text-overflow;\n        }\n      }\n    }\n\n    :deep(.el-input) {\n      height: 48px;\n      line-height: inherit;\n      width: 100%;\n\n      input {\n        height: 48px;\n      }\n\n      .el-input__prefix,\n      .el-input__suffix {\n        display: flex;\n        align-items: center;\n      }\n\n      .el-input__prefix {\n        left: 10px;\n      }\n\n      .el-input__suffix {\n        right: 10px;\n      }\n    }\n\n    .flex-bar {\n      display: flex;\n      justify-content: space-between;\n    }\n\n    .el-checkbox {\n      margin: 20px 0;\n    }\n  }\n\n  .copyright {\n    position: absolute;\n    bottom: 30px;\n    width: 100%;\n    margin: 0;\n    mix-blend-mode: difference;\n  }\n</style>\n","import script from \"./login.vue?vue&type=script&setup=true&name=Login&lang=js\"\nexport * from \"./login.vue?vue&type=script&setup=true&name=Login&lang=js\"\n\nimport \"./login.vue?vue&type=style&index=0&id=2852f384&lang=scss&scoped=true\"\n\nimport exportComponent from \"D:\\\\project\\\\php\\\\quickadmin\\\\vue3\\\\node_modules\\\\@vue\\\\cli-service\\\\node_modules\\\\vue-loader-v16\\\\dist\\\\exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2852f384\"]])\n\nexport default __exports__"],"sourceRoot":""}